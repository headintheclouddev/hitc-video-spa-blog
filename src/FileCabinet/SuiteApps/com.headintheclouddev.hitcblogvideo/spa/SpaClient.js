define(["exports","@uif-js/core/jsx-runtime","@uif-js/core","N","@uif-js/component"],(function(e,t,o,s,n){"use strict";const r=o.ContextType.new("theme-context"),i={CREATE_POST:Symbol("createPost"),FETCH_POSTS:Symbol("fetchPosts"),USER_REGISTER:Symbol("userRegister"),USER_LOGIN:Symbol("userLogin"),USER_LOGOUT:Symbol("userLogout")},c={createPost(e,t,o){const s=Date.now();return{type:i.CREATE_POST,id:s,title:e,content:t,author:o}},fetchPosts:()=>({type:i.FETCH_POSTS,posts:[{id:1,author:"Robbie",title:"Test Post 1",content:"It is a beautiful day to be a NetSuite developer!"},{id:2,author:"Robbie",title:"Test Post 2",content:"Looking forward to SuiteWorld 2026."}]}),userRegister:(e,t)=>({type:i.USER_REGISTER,username:e}),userLogin:(e,t)=>({type:i.USER_LOGIN,username:e}),userLogout:()=>({type:i.USER_LOGOUT})};function l(e,t){return{user:u(e.user,t),posts:a(e.posts,t),error:""}}function u(e,t){switch(t.type){case i.USER_LOGIN:case i.USER_REGISTER:return t.username;case i.USER_LOGOUT:return"";default:return e}}function a(e,t){if(t.type==i.CREATE_POST){return[{title:t.title,content:t.content,author:t.author,id:t.id},...e]}return t.type==i.FETCH_POSTS?t.posts:e}const x={HOMEPAGE:"/",POST:"/view/:id"};function d(e){return t.jsxs("span",{onClick:e.onClick,style:{cursor:"pointer",paddingLeft:"8px",fontWeight:e.active?"bold":"normal"},children:[t.jsx("span",{style:{color:e.theme.primaryColor},children:"Primary"})," / ",t.jsx("span",{style:{color:e.theme.secondaryColor},children:"Secondary"})]})}function h(e){const[n,r]=o.useState([]);function i(t){return t.primaryColor==e.theme.primaryColor&&t.secondaryColor==e.theme.secondaryColor}return o.useEffect((()=>{s.query.runSuiteQL.promise({query:"SELECT name, id, custrecord_blog_theme_secondary_color FROM customrecord_blog_theme"}).then((e=>{const t=e.asMappedResults(),o=[];for(const e of t)o.push({id:e.id,primaryColor:e.name,secondaryColor:e.custrecord_blog_theme_secondary_color});r(o),console.log("ChangedTheme found",t.length,"themes")}))}),[]),t.jsxs("div",{children:["Change Theme:",n.map((o=>t.jsx(d,{theme:o,active:i(o),onClick:()=>e.setTheme(o)})))]})}function p(){const[e,s]=o.useState(""),[r,i]=o.useState(""),l=o.useDispatch(),u={[n.TextBox.Event.TEXT_CHANGED]:({text:e})=>{s(e)}};return t.jsxs("div",{children:[t.jsx("label",{htmlFor:"login-username",children:"Username:"}),t.jsx(n.TextBox,{type:n.TextBox.Type.TEXT,name:"login-username",text:e,on:u}),t.jsx("label",{htmlFor:"login-password",children:"Password:"}),t.jsx(n.TextBox,{type:n.TextBox.Type.PASSWORD,name:"login-password",text:r,onTextChanged:function(e){i(e.text)}}),t.jsx("input",{type:"button",value:"Login",onClick:function(){console.log("handleLogin running"),e&&r&&l(c.userLogin(e,r))}})]})}function j(){return t.jsxs("div",{children:[t.jsx("label",{htmlFor:"register-username",children:"Username:"}),t.jsx(n.TextBox,{type:n.TextBox.Type.TEXT,name:"register-username"}),t.jsx("label",{htmlFor:"register-password",children:"Password:"}),t.jsx(n.TextBox,{type:n.TextBox.Type.PASSWORD,name:"register-password"}),t.jsx("label",{htmlFor:"register-repeat-password",children:"Repeat Password:"}),t.jsx(n.TextBox,{type:n.TextBox.Type.PASSWORD,name:"register-reeat-password"}),t.jsx("input",{type:"button",value:"Register",onClick:function(){console.log("handleRegister running")}})]})}function m(){const e=o.useSelector((e=>e.user)),s=o.useDispatch();return t.jsxs("div",{children:["Logged in as: ",t.jsx("b",{children:e})," ",t.jsx(n.Button,{label:"Logout",action:function(){s(c.userLogout())}})]})}function T(){return o.useSelector((e=>e.user))?t.jsx(o.VDom.Fragment,{children:t.jsx(m,{})}):t.jsxs(o.VDom.Fragment,{children:[t.jsx(p,{}),t.jsx(j,{})]})}function S(){const[e,s]=o.useState(""),[r,i]=o.useState(""),l=o.useDispatch(),u=o.useSelector((e=>e.user));if(!u)return t.jsx("p",{children:"Please log in to create a post."});return t.jsxs("div",{children:[t.jsxs("div",{children:["Author: ",t.jsx("b",{children:u})]}),t.jsxs("div",{children:[t.jsx("label",{htmlFor:"create-title",children:"Title:"}),t.jsx(n.TextBox,{type:n.TextBox.Type.TEXT,name:"create-title",text:e,onTextChanged:function(e){console.log("handleTitle"),s(e.text)}})]}),t.jsx(n.TextArea,{text:r,onTextChanged:function(e){console.log("handleContent"),i(e.text)}}),t.jsx("input",{type:"button",value:"Create",onClick:function(){e&&r&&l(c.createPost(e,r,u))}})]})}function g(e){return t.jsxs("div",{children:[t.jsx("h1",{style:{color:e.theme.primaryColor},children:"NetSuite Blog"}),t.jsx(h,{theme:e.theme,setTheme:e.setTheme}),t.jsx(T,{}),t.jsx(S,{})]})}function y(e){const{secondaryColor:s}=o.useContext(r);let i=e.content;return e.content.length>30&&(i=e.content.substring(0,30)+"..."),t.jsxs("div",{children:[t.jsx("h3",{style:{color:s},children:e.title}),t.jsx("div",{children:i}),t.jsxs("div",{children:[t.jsx("br",{}),t.jsx(n.Link,{route:{route:"/view/:id",parameters:{id:e.id}},children:"View full post"})]}),t.jsx("br",{}),t.jsxs("i",{children:["Written by ",t.jsx("b",{children:e.author})]})]})}function f(){const e=o.useSelector((e=>e.posts)),s=[];for(const n of e)s.push(t.jsxs(o.VDom.Fragment,{children:[t.jsx(y,{...n}),t.jsx("hr",{})]}));return t.jsx("div",{children:s})}function C(){return t.jsx("div",{children:t.jsx(f,{})})}function E(){return t.jsx("div",{children:"Coming soon"})}function R(){const[e,s]=o.useState({user:"",posts:[],error:""}),n=o.useMemo((()=>o.Store.create({reducer:l,state:e,onStateChanged:({currentState:e})=>s(e)})));o.useEffect((()=>n.subscribe((()=>s(n.getState())))),[]),o.useEffect((()=>{console.log("useEffect - fetchPosts",new Date),n.dispatch(c.fetchPosts())}),[]);const[i,u]=o.useState({primaryColor:"deepskyblue",secondaryColor:"coral"}),a={[r]:i};return t.jsx(o.Router.Hash,{children:t.jsx(o.Store.Provider,{store:n,children:t.jsx(o.VDom.Context,{value:a,children:t.jsxs("div",{children:[t.jsx(g,{setTheme:u,theme:i}),t.jsx("hr",{}),t.jsxs(o.Router.Routes,{children:[t.jsx(o.Router.Route,{path:x.HOMEPAGE,exact:!0,children:t.jsx(C,{})}),t.jsx(o.Router.Route,{path:x.POST,exact:!0,children:t.jsx(E,{})})]})]})})})})}e.run=function(e){console.log("SpaClient - run context",e),e.setLayout("application"),e.setContent(t.jsx(R,{}))}}));
